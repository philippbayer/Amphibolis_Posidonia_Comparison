---
title: "Comparing gene loss with overall gene numbers"
author: "Philipp Bayer"
date: "14/09/2021"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
```

Is there an association between the lost number of *candidate* genes and the overall gene number? In other words, is the loss of our ~50 candidate genes driven by overall gene loss, or is it driven by adaptation to aquatic life?

If there's no association between overall gene numbers and the status of our ~50 genes then there might be selection pressure to lose these genes. If there's an association then these candidate genes may not be adaptation to aquatic life, but instead may be lost due to overall genome shrinkage pressure.

This is not currently part of the paper.


Data comes from Gene_content_Amphi_posi.xlsx

```{r}
data.frame(
  stringsAsFactors = FALSE,
                Species = c("A. antarctica","P. australis",
                       "Z. muelleri","Z. marina","L. gibba","S. polyrhiza",
                       "O. lucimarinus","C. reinhardtii","T. salsuginea",
                       "A. trichopada","B. distachyon","O. sativa","P. patens",
                       "P. trichocarpa","S. moellendorfii","A. thaliana",
                       "V. vinifera","Z. mays"),
                `Lost genes` = c(46L,30L,21L,27L,10L,23L,
                       0L,50L,10L,7L,0L,1L,24L,1L,24L,0L,5L,0L),
                Genes = c(16176L,21126L,35875L,21483L,
                       21830L,20661L,7742L,17741L,27132L,26846L,32439L,
                       42189L,32926L,34699L,22285L,35836L,31845L,39498L)
) -> df
```

```{r}
df
```
from getRandomGeneCounts.py

```{r}
random_lost <- data.frame(
  stringsAsFactors = FALSE,
                               Species = c("Z. muelleri","A. trichopada","O. sativa",
                                      "T. salsuginea","P. trichocarpa",
                                      "P. patens","Z. marina","S. polyrhiza",
                                      "C. reinhardtii","S. moellendorffii",
                                      "O. lucimarinus","Z. mays","P. australis",
                                      "L. gibba","V. vinifera","A. antarctica",
                                      "A. thaliana","B. distachyon"),
                               RandomLost = c(34L,34L,28L,36L,37L,40L,38L,40L,39L,
                                      39L,41L,33L,38L,39L,36L,35L,36L,
                                      33L)
               )

both <- left_join(df, random_lost)
bothlong <- both %>% pivot_longer( c('Lost.genes', 'RandomLost'), names_to = 'Type', values_to='Count')
```

```{r}
bothlong %>% ggplot(aes(y = Genes, x= Count, color=Type)) + 
  geom_point() + 
  cowplot::theme_minimal_grid() +
  xlab('Lost genes') 
```

```{r}
fit1 <- lm(Genes ~ Lost.genes, data=df)
summary(fit1)
```

```{r}
fit2 <- lm(Genes ~ RandomLost, data=both)
summary(fit2)
```

```{r}
ggplotRegression <- function (fit) {

require(ggplot2)

ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
                     " Slope =",signif(fit$coef[[2]], 5),
                     " P =",signif(summary(fit)$coef[2,4], 5))) +
  cowplot::theme_minimal_grid() +
  xlab('Lost genes')
}

ggplotRegression(fit1)
```

```{r}
fit2 <- lm(Genes ~ Lost.genes, data=df %>% filter(Genes > 10000))
summary(fit2)
```
```{r}
ggplotRegression(fit2)
```

```{r}
library(patchwork)

ggplotRegression(fit1) + ggplotRegression(fit2)
```

